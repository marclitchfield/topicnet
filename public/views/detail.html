<div ng-controller="DetailController">
	<div class="row">
		<div class="span6">
			<h3 ng-hide="editingTitle" ng-dblclick="editingTitle=true">{{ topic.name }}</h3>
			<h3 ng-show="editingTitle">
				<form class="form-inline">
					<input type="text" class="input-large" ng-model="editedTopicName"></input>
					<button class="btn btn-primary" ng-click="update(); editingTitle=false">Save</button>
					<button class="close" ng-click="editingTitle=false">&times;</button>
				</form>
			</h3>
			<ul class="unstyled">
				<li ng-repeat="resource in topic.resources">
					<a href="#/resources/{{ resource.id }}">{{ resource.title }}</a>
					<small>{{ resource.source }}</small>
				</li>
			</ul>
	        <button class="btn" data-toggle="modal" href="#resourceForm"><i class="icon-plus"></i>Add Resource</button>
		</div>
	</div>

	<div class="row nav-area tabbable">
		<div class="span6">
			<ul class="nav nav-tabs">
				<li class="active"><a href="#sub-topic-pane" data-toggle="tab">sub topics</a></li>
				<li><a href="#next-topic-pane" data-toggle="tab">next</a></li>
			</ul>

			<div class="tab-content">
				<div class="tab-pane active" id="sub-topic-pane" ng-controller="SubTopicController">
					<ul class="unstyled">
						<li ng-repeat="subTopic in topic.sub">
							<a href="#/detail/{{ subTopic.id }}">{{ subTopic.name }}</a>
							<button class="close" ng-click="removeLink(subTopic)">&times;</button>
						</li>
					</ul>
					<div ng-include src="'partials/add-topic.html'" />
				</div>

				<div class="tab-pane" id="next-topic-pane" ng-controller="NextTopicController">
					<ul class="unstyled">
						<li ng-repeat="nextTopic in topic.next">
							<a href="#/detail/{{ nextTopic.id }}">{{ nextTopic.name }}</a>
							<button class="close" ng-click="removeLink(nextTopic)">&times;</button>
						</li>
					</ul>
					<div ng-include src="'partials/add-topic.html'" />
				</div>
			</div>
		</div>
	</div>

	<div id="resourceForm" class="modal fade add-resource-modal" modal-autofocus>
		<form name="resourceForm" novalidate ng-controller="AddResourceController">
			<div class="modal-header">
				<h4>Add a resource</h4>
			</div>
			<div class="modal-body">
				<div class="input-append">
					<input type="text" class="input-xxlarge" ng-model="url" placeholder="URL" autofocus required></input>
					<button class="btn" ng-click="submitUrl()">Submit</span>
				</div>

				<div ng-show="statusMessage" class="alert">{{ statusMessage }}</div>

				<p>
					<input type="text" class="input-xlarge" ng-disabled="!urlSubmitted" ng-model="title" placeholder="Title" required></input>
					<input type="text" class="input-xlarge" ng-disabled="!urlSubmitted" ng-model="source" placeholder="Source" required></input>
				</p>
			</div>
			<div class="modal-footer">
				<button class="btn btn-primary" data-dismiss="modal" ng-hide="resourceForm.$invalid" ng-click="add()">Save</button>
				<button class="btn" data-dismiss="modal" ng-click="clear()">Cancel</button>
			</div>
		</form>
	</div>
</div>
