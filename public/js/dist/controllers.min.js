
function AddResourceController($scope,$http,$routeParams,$location){$http.get('/topics/'+$routeParams.topicId).success(function(topic){$scope.topic=topic;}).error(function(message){$scope.$emit('error',message);});function redirectToTopic(){$location.path('topics/'+$scope.topic.id);}
$scope.submitUrl=function(){if($scope.url){$http.get('/resources?url='+encodeURIComponent($scope.url)).success(function(resources){$scope.urlSubmitted=true;if(resources.length>0){$scope.title=resources[0].title;$scope.source=resources[0].source;$scope.resourceId=resources[0].id;$scope.verb=resources[0].verb;$scope.isNewResource=false;$scope.statusMessage='Resource was found in the system';}else{$scope.title=null;$scope.source=null;$scope.resourceId=null;$scope.isNewResource=true;$scope.statusMessage='Resource was not in the system. Please enter details';}}).error(function(message){$scope.$emit('error',message);});}};$scope.add=function(){var resourceData={title:$scope.title,url:$scope.url,source:$scope.source,verb:$scope.verb.toLowerCase()};if($scope.isNewResource){$http.post('/resources',resourceData).success(function(resource){$http.post('/topics/'+$scope.topic.id+'/resources',{resid:resource.id}).success(function(){redirectToTopic();}).error(function(message){$scope.$emit('error',message);});}).error(function(message){$scope.$emit('error',message);});}else{$http.post('/topics/'+$scope.topic.id+'/resources',{resid:$scope.resourceId}).success(function(){redirectToTopic();}).error(function(message){$scope.$emit('error',message);});}};$scope.cancel=function(){redirectToTopic();};}
function AddTopicController($scope,$http){$scope.$on('topicSelected',function(e,topic){$scope.selectedTopic=topic;});$scope.show=function(){$scope.formVisible=true;};$scope.add=function(){if($scope.selectedTopic&&$scope.selectedTopic.hasOwnProperty('id')){$scope.linkfn($scope.selectedTopic);}else{$http.post('/topics',{name:$scope.searchQuery}).success(function(topic){$scope.linkfn(topic);}).error(function(message){$scope.$emit('error',message);});}
$scope.clear();};$scope.clear=function(){$scope.formVisible=false;$scope.searchQuery='';};}
function ErrorController($scope){$scope.$on('error',function(e,message){$scope.errorMessage=message;setTimeout(function(){if($scope.errorMessage===message){$scope.errorMessage=null;$scope.$apply();}},3000);})}
function RelatedTopicController($scope,$http){$scope.linkfn=function addRelatedTopic(toTopic){$http.post('/topics/'+$scope.topic.id+'/'+$scope.rel,{toid:toTopic.id}).success(function(){$scope.topic[$scope.rel].push(toTopic);}).error(function(message){$scope.$emit('error',message);});};$scope.removeLink=function(toTopic){$http['delete']('/topics/'+$scope.topic.id+'/'+$scope.rel+'/'+toTopic.id).success(function(){$scope.topic[$scope.rel]=$scope.topic[$scope.rel].filter(function(t){return t.id!==toTopic.id;});}).error(function(message){$scope.$emit('error',message);});};function vote(relationship,toTopic,dir){var voteUrl='/topics/'+$scope.topic.id+'/'+relationship+'/'+toTopic.id+'/vote';$http.post(voteUrl,{dir:dir}).error(function(message){$scope.$emit('error',message);});}
$scope.upvote=function(relationship,toTopic){vote(relationship,toTopic,'up');};$scope.downvote=function(relationship,toTopic){vote(relationship,toTopic,'down');};}
function ResourceDetailController($scope,$http,$routeParams){$http.get('/resources/'+$routeParams.resourceId).success(function(resource){$scope.resource=resource;}).error(function(message){$scope.$emit('error',message);});}
function RootController($scope,$http){$http.get('/topics').success(function(topics){$scope.rootTopics=topics;});$scope.linkfn=function makeRoot(topic){$http.post('/topics/'+topic.id+'/root').success(function(){$scope.rootTopics.push(topic);}).error(function(message){$scope.$emit('error',message);});};$scope.removeRoot=function(topic){$http['delete']('/topics/'+topic.id+'/root').success(function(){$scope.rootTopics=$scope.rootTopics.filter(function(t){return t.id!==topic.id;});}).error(function(message){$scope.$emit('error',message);});};}
function TopicDetailController($scope,$http,$routeParams){$http.get('/topics/'+$routeParams.topicId).success(function(topic){$scope.topic=topic;$scope.topic.resources=$scope.topic.resources||[];$scope.topic.sub=$scope.topic.sub||[];$scope.topic.next=$scope.topic.next||[];$scope.editedTopicName=topic.name;}).error(function(message){$scope.$emit('error',message);});$scope.update=function(){$http.put('/topics/'+$scope.topic.id,{name:$scope.editedTopicName}).success(function(){$scope.topic.name=$scope.editedTopicName;}).error(function(message){$scope.$emit('error',message);});};function vote(resource,dir){var voteUrl='/topics/'+$scope.topic.id+'/resources/'+resource.id+'/vote';$http.post(voteUrl,{dir:dir}).error(function(message){$scope.$emit('error',message);});}
$scope.upvote=function(resource){vote(resource,'up');};$scope.downvote=function(resource){vote(resource,'down');};}
//@ sourceMappingURL=controllers.js.map